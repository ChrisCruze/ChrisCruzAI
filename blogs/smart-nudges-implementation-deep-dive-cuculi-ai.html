<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Nudges - Implementation Deep Dive | Cuculi AI</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’¡</text></svg>">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style type="text/tailwindcss">
        :root {
            --primary-color: #4f46e5; /* Indigo 600 */
            --secondary-color: #f8fafc; /* Slate 50 */
            --text-primary: #1e293b; /* Slate 800 */
            --text-secondary: #64748b; /* Slate 500 */
            --border-color: #e2e8f0; /* Slate 200 */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* Slate 100 */
        }
        
        /* Custom Styles for Components */
        .section-card {
            @apply bg-white rounded-2xl shadow-lg p-6 md:p-10 mb-12 transition-all duration-300;
        }

        .section-title {
            @apply text-3xl font-bold mb-8 text-indigo-600 flex items-center gap-3;
        }
        
        .section-title .material-symbols-outlined {
            @apply text-4xl;
        }

        .hero {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }

        /* Accordion styles for Progressive Disclosure */
        .accordion-item .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .accordion-item.open .accordion-content {
            max-height: 5000px; /* Adjust as needed */
        }
        .accordion-item.open .accordion-icon {
            transform: rotate(45deg);
        }
        .accordion-trigger {
            @apply flex justify-between items-center w-full text-left py-4 px-5 rounded-lg font-semibold text-lg cursor-pointer transition-colors duration-300;
        }
        .accordion-icon {
            @apply transition-transform duration-300 material-symbols-outlined;
        }

        /* Light Theme Accordion */
        .accordion-light .accordion-item { @apply bg-white border border-slate-200 rounded-lg; }
        .accordion-light .accordion-trigger { @apply bg-slate-50 hover:bg-slate-100 text-slate-800; }
        .accordion-light .accordion-content { @apply p-5 pt-2 text-slate-600; }
        
        /* Dark Theme Accordion */
        .accordion-dark .accordion-item { @apply bg-slate-700 border border-slate-600 rounded-lg; }
        .accordion-dark .accordion-trigger { @apply bg-slate-700 text-slate-200 hover:bg-slate-600; }
        .accordion-dark .accordion-content { @apply p-5 pt-2 text-slate-300; }

        /* Sticky Header */
        header {
            @apply sticky top-0 z-50 backdrop-blur-lg bg-white/80 transition-shadow duration-300;
        }
        header.scrolled {
             @apply shadow-md;
        }
        
        nav a.active {
            @apply text-indigo-600 font-semibold;
        }
        
        /* Reimagined Architecture Diagram */
        .arch-diagram { @apply flex flex-col md:flex-row items-center justify-center gap-2 text-center my-8; }
        .arch-node { @apply bg-slate-100 border border-slate-300 rounded-lg p-4 w-48 shadow-sm text-sm font-semibold text-slate-700; }
        .arch-arrow { @apply text-slate-400 font-bold text-2xl transform; }

        /* Code Block Styling */
        .code-block {
            @apply bg-slate-800 text-slate-200 p-5 rounded-lg font-mono text-sm overflow-x-auto my-4;
            @apply ring-2 ring-slate-700;
        }
        .code-block-header {
            @apply flex justify-between items-center pb-3 mb-3 border-b border-slate-600;
        }
        .code-block-title {
            @apply text-slate-400 font-semibold;
        }

    </style>
</head>

<body>
    <div class="relative min-h-screen flex flex-col">
        <!-- Header -->
        <header id="main-header" class="border-b border-solid border-[var(--border-color)]">
            <div class="container mx-auto px-6">
                <div class="flex items-center justify-between h-20">
                    <div class="flex items-center gap-4">
                        <svg class="size-8 text-[var(--primary-color)]" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                            <path clip-rule="evenodd" d="M12.0799 24L4 19.2479L9.95537 8.75216L18.04 13.4961L18.0446 4H29.9554L29.96 13.4961L38.0446 8.75216L44 19.2479L35.92 24L44 28.7521L38.0446 39.2479L29.96 34.5039L29.9554 44H18.0446L18.04 34.5039L9.95537 39.2479L4 28.7521L12.0799 24Z" fill="currentColor" fill-rule="evenodd"></path>
                        </svg>
                        <h1 class="text-[var(--text-primary)] text-xl font-bold tracking-tighter">Cuculi AI Vision</h1>
                    </div>
                    <nav class="hidden lg:flex items-center gap-6">
                        <a class="nav-link text-[var(--text-secondary)] hover:text-[var(--primary-color)] text-sm font-medium leading-normal transition-colors" href="#pillars">Pillars</a>
                        <a class="nav-link text-[var(--text-secondary)] hover:text-[var(--primary-color)] text-sm font-medium leading-normal transition-colors" href="#architecture">Architecture</a>
                        <a class="nav-link text-[var(--text-secondary)] hover:text-[var(--primary-color)] text-sm font-medium leading-normal transition-colors" href="#roadmap">Roadmap</a>
                        <a class="nav-link text-[var(--text-secondary)] hover:text-[var(--primary-color)] text-sm font-medium leading-normal transition-colors" href="#tech-stack">Tech Stack</a>
                        <a class="nav-link text-[var(--text-secondary)] hover:text-[var(--primary-color)] text-sm font-medium leading-normal transition-colors" href="#metrics">Metrics</a>
                        <a class="nav-link text-[var(--text-secondary)] hover:text-[var(--primary-color)] text-sm font-medium leading-normal transition-colors" href="#atomic-notes">Atomic Notes</a>
                    </nav>
                </div>
            </div>
        </header>

        <main class="flex-1">
            <div class="container mx-auto px-6 py-12 md:py-20">

                <!-- Hero Section -->
                <section class="hero text-white text-center py-20 px-6 rounded-3xl mb-16">
                    <h1 class="text-5xl md:text-6xl font-black mb-4 tracking-tight">Smart Nudges: The Four-Pillar System</h1>
                    <p class="text-xl md:text-2xl max-w-3xl mx-auto text-indigo-200">A behavior design engine that combines intuitive control, evidence-based psychology, precise trigger orchestration, and a resilient messaging stack to activate Cuculi tables.</p>
                </section>

                <!-- 10 Pillar Playbook Section -->
                <section id="pillars" class="section-card">
                    <h2 class="section-title"><span class="material-symbols-outlined">checklist</span>The Four Behavioral Pillars</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mb-6">Each pillar aligns the team on how we guide people to tables: give operators real-time insight, speak to intrinsic motivations, orchestrate triggers with precision, and ship every message on the right channel.</p>
                    <div id="pillars-accordion" class="accordion-container accordion-light space-y-4">
                        <!-- Playbook accordion items will be generated by JS -->
                    </div>
                </section>
                
                <!-- Technical Architecture -->
                <section id="architecture" class="section-card">
                    <h2 class="section-title"><span class="material-symbols-outlined">account_tree</span>Microservices Architecture</h2>
                    <div class="arch-diagram">
                        <div class="arch-node">User &amp; Event Signals</div>
                        <div class="arch-arrow md:rotate-0 rotate-90">&rarr;</div>
                        <div class="arch-node">MongoDB Change Streams</div>
                        <div class="arch-arrow md:rotate-0 rotate-90">&rarr;</div>
                        <div class="arch-node">Lambda Trigger Orchestrator</div>
                        <div class="arch-arrow md:rotate-0 rotate-90">&rarr;</div>
                        <div class="arch-node">Twilio Â· OneSignal Â· Mailchimp</div>
                    </div>
                     <div class="arch-diagram md:flex-row-reverse">
                        <div class="arch-node">Insight Control Tower</div>
                        <div class="arch-arrow md:rotate-180 rotate-90">&larr;</div>
                        <div class="arch-node">Behavioral Playbooks &amp; Personalization</div>
                        <div class="arch-arrow md:rotate-180 rotate-90">&larr;</div>
                        <div class="arch-node">Trigger Configuration Matrix</div>
                    </div>
                </section>
                
                <!-- Implementation Timeline -->
                <section id="roadmap" class="section-card">
                    <h2 class="section-title"><span class="material-symbols-outlined">calendar_month</span>Pillar Activation Roadmap</h2>
                     <div class="relative border-l-2 border-indigo-200 pl-10 space-y-12">
                         <div class="timeline-item">
                            <div class="absolute -left-3.5 top-0 size-6 bg-indigo-500 rounded-full border-4 border-white"></div>
                            <p class="text-indigo-500 font-semibold mb-1">Phase 1 Â· Sep 2025</p>
                            <h4 class="font-bold text-lg mb-2">Launch Insight Control Tower</h4>
                            <p class="text-sm text-slate-600">Instrument dashboards that slice messages by user, event, and weekday cadence so operators can see backlog, collisions, and campaign lift in near real time.</p>
                         </div>
                         <div class="timeline-item">
                             <div class="absolute -left-3.5 top-0 size-6 bg-indigo-500 rounded-full border-4 border-white"></div>
                            <p class="text-indigo-500 font-semibold mb-1">Phase 2 Â· Oct 2025</p>
                            <h4 class="font-bold text-lg mb-2">Operationalize Behavioral Playbooks</h4>
                            <p class="text-sm text-slate-600">Codify scarcity, social proof, and reciprocity scripts with personalization tokens; run copy experiments anchored in Cialdini, Fogg, and Ariely research to prime RSVPs.</p>
                         </div>
                         <div class="timeline-item">
                            <div class="absolute -left-3.5 top-0 size-6 bg-indigo-500 rounded-full border-4 border-white"></div>
                            <p class="text-indigo-500 font-semibold mb-1">Phase 3 Â· Nov 2025</p>
                            <h4 class="font-bold text-lg mb-2">Deploy Trigger Configuration Matrix</h4>
                            <p class="text-sm text-slate-600">Ship YAML-driven trigger recipes that combine user segments, event milestones, and temporal rules with guardrails, plus regression tests to keep the matrix predictable.</p>
                         </div>
                         <div class="timeline-item">
                             <div class="absolute -left-3.5 top-0 size-6 bg-indigo-500 rounded-full border-4 border-white"></div>
                            <p class="text-indigo-500 font-semibold mb-1">Phase 4 Â· Dec 2025</p>
                            <h4 class="font-bold text-lg mb-2">Harden Multi-Channel Delivery</h4>
                            <p class="text-sm text-slate-600">Integrate Twilio SMS, OneSignal push, and Mailchimp email behind Lambda routing, add failover logic, and feed delivery analytics back into the dashboards.</p>
                         </div>
                     </div>
                </section>
                
                <!-- Technical Details Accordion -->
                <section id="tech-stack" class="section-card bg-slate-800 text-white">
                    <h2 class="section-title !text-white"><span class="material-symbols-outlined">code</span>Composable Delivery Stack</h2>
                     <p class="text-lg text-slate-300 mb-8 max-w-3xl">Every pillar is backed by durable services: MongoDB triggers orchestrate data flow, AWS Lambda shapes logic, and Twilio, OneSignal, and Mailchimp deliver contextually-tuned outreach.</p>
                     <div id="tech-accordion" class="accordion-container accordion-dark space-y-4">
                        <!-- Technical accordion items will be generated here -->
                    </div>
                </section>

                <!-- Success Metrics -->
                <section id="metrics" class="section-card">
                    <h2 class="section-title"><span class="material-symbols-outlined">query_stats</span>Global Success Metrics</h2>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="font-semibold text-slate-800 mb-2 border-b pb-2">ðŸ›° Insight &amp; Control</h3>
                            <ul class="text-sm text-slate-600 space-y-1 list-disc pl-5">
                                <li>Message review coverage by user, event, and send window</li>
                                <li>Exception resolution time for conflicting nudges</li>
                                <li>Same-day visibility of delivery success and failures</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="font-semibold text-slate-800 mb-2 border-b pb-2">ðŸ§  Behavioral Impact</h3>
                            <ul class="text-sm text-slate-600 space-y-1 list-disc pl-5">
                                <li>RSVP lift from scarcity, social proof, and reciprocity variants</li>
                                <li>Share of messages personalized with contextual data</li>
                                <li>Qualitative sentiment from post-event reciprocity prompts</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="font-semibold text-slate-800 mb-2 border-b pb-2">ðŸ§© Trigger Precision</h3>
                            <ul class="text-sm text-slate-600 space-y-1 list-disc pl-5">
                                <li>On-time trigger execution across user, event, and calendar rules</li>
                                <li>Suppression accuracy vs. manual overrides</li>
                                <li>Regression coverage for new YAML recipes</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="font-semibold text-slate-800 mb-2 border-b pb-2">ðŸ“¡ Channel Reliability</h3>
                            <ul class="text-sm text-slate-600 space-y-1 list-disc pl-5">
                                <li>Delivery rate by Twilio SMS, OneSignal push, and Mailchimp email</li>
                                <li>Latency from trigger decision to confirmed send</li>
                                <li>Automated retries and failover success rate</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Atomic Notes Section -->
                <section id="atomic-notes" class="section-card">
                    <h2 class="section-title"><span class="material-symbols-outlined">menu_book</span>Atomic Notes &amp; Research</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mb-8">Dive deeper into each pillar with rapid-reference notes that synthesize research, operating procedures, and instrumentation checklists.</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <a href="../notes/smart-nudges-insight-control-note.html" class="block p-6 rounded-2xl border border-slate-200 hover:border-indigo-400 hover:shadow-lg transition bg-white">
                            <h3 class="text-xl font-semibold text-slate-900 mb-2">Insight &amp; Control Tower Blueprint</h3>
                            <p class="text-sm text-slate-600">Dashboards, alerting cadences, and audit workflows for reviewing nudges by user, event, and calendar window.</p>
                        </a>
                        <a href="../notes/smart-nudges-psychology-impact-note.html" class="block p-6 rounded-2xl border border-slate-200 hover:border-indigo-400 hover:shadow-lg transition bg-white">
                            <h3 class="text-xl font-semibold text-slate-900 mb-2">Behavioral Psychology Evidence Pack</h3>
                            <p class="text-sm text-slate-600">Research-backed guidance on scarcity, social proof, and reciprocity, including copy frameworks and measurement ideas.</p>
                        </a>
                        <a href="../notes/smart-nudges-trigger-configuration-note.html" class="block p-6 rounded-2xl border border-slate-200 hover:border-indigo-400 hover:shadow-lg transition bg-white">
                            <h3 class="text-xl font-semibold text-slate-900 mb-2">Trigger Configuration Matrix</h3>
                            <p class="text-sm text-slate-600">User, event, and temporal recipes with guardrails for rapid experimentation and safe automation.</p>
                        </a>
                        <a href="../notes/smart-nudges-delivery-stack-note.html" class="block p-6 rounded-2xl border border-slate-200 hover:border-indigo-400 hover:shadow-lg transition bg-white">
                            <h3 class="text-xl font-semibold text-slate-900 mb-2">Messaging Stack Reliability Guide</h3>
                            <p class="text-sm text-slate-600">MongoDB trigger patterns, Lambda orchestration, and Twilio/OneSignal/Mailchimp delivery checks.</p>
                        </a>
                    </div>
                </section>

                <!-- Summary Section -->
                <section class="bg-indigo-700 text-white text-center py-12 px-6 rounded-3xl">
                    <h2 class="text-3xl font-bold mb-4">One System, Four Reinforcing Pillars</h2>
                    <p class="text-lg max-w-4xl mx-auto text-indigo-200 leading-relaxed">
                        Smart Nudges thrives when operators can inspect every outreach, messages are grounded in human psychology, triggers execute with confidence, and the delivery stack never drops a notification. These pillars give Cuculi the clarity to experiment quickly and the rigor to sustain growth.
                    </p>
                </section>
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // --- Generic Accordion Setup ---
    function setupAccordion(containerId, items) {
        const container = document.getElementById(containerId);
        if (!container) return;

        container.innerHTML = items.map((item, index) => {
            const triggerContent = item.trigger || `<span>${item.title}</span>`;
            return `
            <div class="accordion-item">
                <div class="accordion-trigger" data-index="${index}">
                    ${triggerContent}
                    <span class="accordion-icon">+</span>
                </div>
                <div class="accordion-content">
                    ${item.content}
                </div>
            </div>`;
        }).join('');
    }

    // --- Data for Accordions ---

    // 1. Pillars Accordion Data
    const pillarItems = [
        {
            trigger: `<div class="flex items-start gap-4"><span class="material-symbols-outlined text-indigo-500 bg-indigo-100 p-2 rounded-full">monitoring</span><div><h3 class="font-semibold text-slate-800 mb-1">1. Insight & Control Tower</h3><p class="text-sm text-slate-500 font-normal">Dashboards where every message can be audited by user, event, and calendar.</p></div></div>`,
            content: `
                <p class="mb-3">Operators get a single surface to answer "what went out, to whom, and why" in seconds.</p>
                <ul class="list-disc pl-5 space-y-2 text-sm">
                    <li><strong>User Timelines:</strong> Inspect all queued, sent, and suppressed nudges for an individual.</li>
                    <li><strong>Event Heatmaps:</strong> Track seat inventory, join velocity, and messaging bursts per table.</li>
                    <li><strong>Temporal Views:</strong> Compare performance by weekday and hour to schedule next-best sends.</li>
                </ul>
            `
        },
        {
            trigger: `<div class="flex items-start gap-4"><span class="material-symbols-outlined text-indigo-500 bg-indigo-100 p-2 rounded-full">psychology</span><div><h3 class="font-semibold text-slate-800 mb-1">2. Behavioral Playbooks</h3><p class="text-sm text-slate-500 font-normal">Scarcity, social proof, and reciprocity scripts personalized at send time.</p></div></div>`,
            content: `
                <p class="mb-3">Grounded in Cialdini's principles of influence, BJ Fogg's behavior model, and Ariely's research on reciprocity, every message taps motivation, ability, and timely triggers.</p>
                <ul class="list-disc pl-5 space-y-2 text-sm">
                    <li><strong>Scarcity:</strong> Highlight diminishing seats or expiring perks to prompt immediate RSVPs.</li>
                    <li><strong>Social Proof:</strong> Showcase who else is attendingâ€”"Three founders you follow already joined."</li>
                    <li><strong>Reciprocity:</strong> Deliver post-event value, like insider notes or gratitude messages, to earn future engagement.</li>
                </ul>
            `
        },
        {
            trigger: `<div class="flex items-start gap-4"><span class="material-symbols-outlined text-indigo-500 bg-indigo-100 p-2 rounded-full">tune</span><div><h3 class="font-semibold text-slate-800 mb-1">3. Trigger Configuration Matrix</h3><p class="text-sm text-slate-500 font-normal">Composable recipes spanning user cohorts, event states, and date-time logic.</p></div></div>`,
            content: `
                <p class="mb-3">Product and lifecycle teams shape experiments by editing declarative YAML, not shipping code.</p>
                <ul class="list-disc pl-5 space-y-2 text-sm">
                    <li><strong>User Dimensions:</strong> Lifecycle stage, attendance history, reciprocity score.</li>
                    <li><strong>Event Dimensions:</strong> Capacity thresholds, host actions, vibe or cuisine tags.</li>
                    <li><strong>Time Dimensions:</strong> Countdown windows, weekday biases, local quiet hours.</li>
                </ul>
            `
        },
        {
            trigger: `<div class="flex items-start gap-4"><span class="material-symbols-outlined text-indigo-500 bg-indigo-100 p-2 rounded-full">hub</span><div><h3 class="font-semibold text-slate-800 mb-1">4. Delivery Stack Reliability</h3><p class="text-sm text-slate-500 font-normal">MongoDB triggers, AWS Lambda, Twilio, OneSignal, and Mailchimp working in concert.</p></div></div>`,
            content: `
                <p class="mb-3">Channel choice and execution quality are first-class citizens, not afterthoughts.</p>
                <ul class="list-disc pl-5 space-y-2 text-sm">
                    <li><strong>MongoDB:</strong> Change streams fire triggers the moment user or event states shift.</li>
                    <li><strong>AWS Lambda:</strong> Evaluates rules, enriches with personalization context, and routes messages.</li>
                    <li><strong>Channel Providers:</strong> Twilio SMS, OneSignal push, and Mailchimp email deliver with feedback loops flowing back into the dashboards.</li>
                </ul>
            `
        }
    ];

    // 2. Technical Details Accordion Data
    const techItems = [
        {
            title: 'Insight Control Tower Instrumentation',
            content: `
            <p class="mb-4">Blend operational metrics with behavioral analytics so every stakeholder sees the same truth.</p>
            <ul class="list-disc pl-5 space-y-2 text-sm mb-4">
                <li><strong>Looker + Metabase:</strong> Combine drag-and-drop exploration with governed datasets.</li>
                <li><strong>Segmented Views:</strong> Filters for user, event, and weekday ensure root-cause analysis stays fast.</li>
                <li><strong>Feedback Loop:</strong> Delivery receipts feed MongoDB so dashboards refresh within minutes.</li>
            </ul>
            `
        },
        {
            title: 'Behavioral Messaging Research Stack',
            content: `
            <p class="mb-4">Translate academic findings into copy systems that scale.</p>
            <ul class="list-disc pl-5 space-y-2 text-sm mb-4">
                <li><strong>Cialdini (Influence, 2009):</strong> Social proof headlines and scarcity counters raise intent.</li>
                <li><strong>BJ Fogg Model:</strong> Pair ability boosts (clear CTAs) with motivation triggers at optimal times.</li>
                <li><strong>Dan Ariely Reciprocity Studies:</strong> Follow-up gratitude notes increase repeat participation.</li>
            </ul>
            <p class="text-sm">Copy variants, tone, and personalization tokens live in Git-backed libraries for rapid experimentation.</p>
            `
        },
        {
            title: 'Trigger & Delivery Pipeline',
            content: `
                <p class="mb-4">MongoDB change streams invoke a Lambda fan-out that evaluates trigger recipes and routes messages to the right channel.</p>
                <div class="code-block-header">
                     <span class="code-block-title">lambda_dispatcher.js</span>
                     <button class="copy-btn text-xs bg-slate-600 px-2 py-1 rounded hover:bg-slate-500">Copy</button>
                </div>
                <pre class="code-block"><code>exports.handler = async (event) => {
  const change = parseMongoChange(event);
  const context = await hydrateContext(change.userId, change.eventId);
  const recipes = await loadRecipes();
  const matches = evaluate(recipes, context);

  for (const match of matches) {
    await route({
      channel: match.channel, // twilio | onesignal | mailchimp
      payload: personalize(match.template, context)
    });
  }
};</code></pre>
            `
        }
    ];

    // Initialize all accordions
    setupAccordion('pillars-accordion', pillarItems);
    setupAccordion('tech-accordion', techItems);
    
    // --- Accordion Click Handler ---
    document.querySelectorAll('.accordion-container').forEach(container => {
        container.addEventListener('click', function(e) {
            const trigger = e.target.closest('.accordion-trigger');
            if (trigger) {
                const item = trigger.parentElement;
                item.classList.toggle('open');
            }
        });
    });
    
    // --- Sticky Header Logic ---
    const header = document.getElementById('main-header');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
            header.classList.add('scrolled');
        } else {
            header.classList.remove('scrolled');
        }
    });

    // --- Active Nav Link on Scroll ---
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.nav-link');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === entry.target.id) {
                        link.classList.add('active');
                    }
                });
            }
        });
    }, { rootMargin: '-30% 0px -70% 0px' });

    sections.forEach(section => {
        observer.observe(section);
    });

    // --- Code Copying Logic ---
    document.body.addEventListener('click', function(e) {
        const copyBtn = e.target.closest('.copy-btn');
        if (copyBtn) {
            const codeBlock = copyBtn.closest('.accordion-content').querySelector('pre code');
            if (codeBlock) {
                const textToCopy = codeBlock.innerText;
                const tempTextarea = document.createElement('textarea');
                tempTextarea.value = textToCopy;
                document.body.appendChild(tempTextarea);
                tempTextarea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextarea);
                
                copyBtn.innerText = 'Copied!';
                setTimeout(() => { copyBtn.innerText = 'Copy'; }, 2000);
            }
        }
    });
});
</script>

</body>
</html>
